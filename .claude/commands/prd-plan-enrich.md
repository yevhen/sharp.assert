Study @prd.md and ultra think detailed final implementation plan including testing. 

The tests should be absolutely minimal but should have 100% branch coverage. 

The final plan should not be step-by-step waterfall plan but rather outcome-based, test-first iterative approach 
with small increments roughly 1-story point size. Each increment should be atomic enough to move the feature forward 
(think deep how to break into increments). 

Enrich respective blocks in `prd.md` with all required details.